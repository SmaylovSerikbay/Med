# Сценарии тестирования системы ProfMed.kz

## Тестовые данные

### Номера телефонов:
- **Клиника:** 77085446945
- **Организация (Работодатель):** 77776875411
- **Врач:** 77021491010
- **Сотрудник:** 77789171790

---

## Сценарий 1: Полный цикл согласно Приказу 131

### Этап 1: Регистрация и настройка

1. **Регистрация Клиники**
   - Номер: 77085446945
   - Создать организацию типа "Клиника"
   - Настроить пропускную способность: 30 человек/день
   - Добавить врачей (включая профпатолога)

2. **Регистрация Работодателя**
   - Номер: 77776875411
   - Создать организацию типа "Работодатель"
   - Добавить сотрудников

3. **Установление партнерства**
   - Работодатель запрашивает партнерство у клиники
   - Клиника подтверждает партнерство
   - Устанавливается цена: 5000 тенге

### Этап 2: Подготовка документов

1. **Генерация Приложения 3**
   - Клиника генерирует Приложение 3 для работодателя
   - Проверка: список сотрудников, которым нужен осмотр

2. **Генерация Календарного плана**
   - Клиника генерирует календарный план
   - Распределение сотрудников по датам
   - **Автоматически создаются осмотры**
   - **Отправляются уведомления с QR-кодами**

### Этап 3: Прохождение осмотра

1. **Регистрация в клинике**
   - Сотрудник (77789171790) приходит в клинику
   - Показывает QR-код
   - Регистратор сканирует QR-код

2. **Осмотр врачами**
   - Врач (77021491010) заполняет результаты
   - Добавляются результаты по каждому фактору

3. **Заключение профпатолога**
   - Профпатолог выносит финальное заключение
   - **Автоматически генерируется справка 075/у**

### Этап 4: Результаты

1. **Генерация Заключительного акта**
   - Клиника генерирует акт
   - Трехстороннее подписание (Клиника → Работодатель → СЭС)

2. **Проверка результатов**
   - Работодатель видит статус сотрудника: ГОДЕН
   - Доступна справка 075/у для скачивания

---

## Команды для запуска тестов

### Запуск всех тестов:
```bash
cd backend
python manage.py test apps.organizations.tests apps.documents.tests apps.medical_examinations.tests
```

### Запуск интеграционного теста:
```bash
cd backend
python manage.py test apps.integration_tests.FullWorkflowTestCase
```

### Запуск с покрытием:
```bash
cd backend
coverage run --source='.' manage.py test
coverage report
```

---

## Проверка по номерам телефонов

### Тест для клиники (77085446945):
1. Вход в систему
2. Просмотр запросов на партнерство
3. Подтверждение партнерства
4. Генерация документов
5. Просмотр назначенных осмотров

### Тест для работодателя (77776875411):
1. Вход в систему
2. Добавление сотрудников
3. Запрос партнерства с клиникой
4. Просмотр осмотров сотрудников
5. Просмотр документов и справок

### Тест для врача (77021491010):
1. Вход в систему (через клинику)
2. Просмотр назначенных осмотров
3. Заполнение результатов осмотра

### Тест для сотрудника (77789171790):
1. Вход в систему
2. Получение уведомления с QR-кодом
3. Просмотр назначенного осмотра
4. Просмотр результатов и справок

